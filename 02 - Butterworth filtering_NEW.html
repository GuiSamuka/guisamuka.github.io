

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Reading the data &mdash; Filtering Techniques</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Read .fits data" href="01%20-%20Manipulating%20fits%20files.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Filtering Techniques of Light Curves Obtained from CoRoT and Kepler satellites
          

          
            
            <img src="_static/Logos_white_bg.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Manipulating fits files:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="01%20-%20Manipulating%20fits%20files.html">Read <em>.fits</em> data</a></li>
<li class="toctree-l1"><a class="reference internal" href="01%20-%20Manipulating%20fits%20files.html#Knowing-and-fixing-the-header">Knowing and fixing the header</a></li>
<li class="toctree-l1"><a class="reference internal" href="01%20-%20Manipulating%20fits%20files.html#Algorithms">Algorithms</a></li>
</ul>
<p class="caption"><span class="caption-text">Butterworth Filter:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Reading the data</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Frequency-Domain-Filtering-Fundamentals">Frequency Domain Filtering Fundamentals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Expand-LightCurves-borders">Expand LightCurves borders</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Avoiding-wraparound-error">Avoiding <em>wraparound</em> error</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Centering-the-transform">Centering the transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Taking-the-Fourier-transform">Taking the Fourier transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Butterworth-transfer-function">Butterworth transfer function</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Applying-filter">Applying filter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Inverse-Fourier-transform">Inverse Fourier transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Removing-Zero-Padding">Removing Zero-Padding</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Removing-borders-expanded">Removing borders expanded</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Re-multiplying-data-by-(-1)^{x}">Re-multiplying data by <img class="math" src="_images/math/9ec9d8503ebeca93f76392ff08cd9cddb66fc223.png" alt="(-1)^{x}"/></a></li>
<li class="toctree-l2"><a class="reference internal" href="#Results">Results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Generating-algorithm-…">Generating algorithm …</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Filtering Techniques of Light Curves Obtained from CoRoT and Kepler satellites</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Reading the data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/02 - Butterworth filtering_NEW.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Reading-the-data">
<h1>Reading the data<a class="headerlink" href="#Reading-the-data" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>Lately, the <em>.fits</em> data was transformed into <em>.csv</em> and saved in database/csv_files. We are going to import a light curve sample and work with it.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">FILE_PATH</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/01 - Iniciação Científica/02 - Datasets/csv_files/EN2_STAR_MON_0100725706_20070516T060226_20071005T074409.csv&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data_sample</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">FILE_PATH</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data_sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DATE</th>
      <th>WHITEFLUX</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2007-05-16 18:11:00.787644</td>
      <td>75564.110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2007-05-16 18:19:32.829687</td>
      <td>75574.570</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2007-05-16 18:28:04.871730</td>
      <td>75547.414</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2007-05-16 18:36:36.913772</td>
      <td>75688.330</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2007-05-16 18:45:08.955815</td>
      <td>75712.540</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>23947</th>
      <td>2007-10-05 19:07:57.408340</td>
      <td>76158.750</td>
    </tr>
    <tr>
      <th>23948</th>
      <td>2007-10-05 19:16:29.363037</td>
      <td>76133.880</td>
    </tr>
    <tr>
      <th>23949</th>
      <td>2007-10-05 19:25:01.317813</td>
      <td>76243.290</td>
    </tr>
    <tr>
      <th>23950</th>
      <td>2007-10-05 19:33:33.272550</td>
      <td>76274.560</td>
    </tr>
    <tr>
      <th>23951</th>
      <td>2007-10-05 19:42:05.227287</td>
      <td>76266.960</td>
    </tr>
  </tbody>
</table>
<p>23952 rows × 2 columns</p>
</div></div>
</div>
<p>Justify why we are transforming into x and y</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">data_sample</span><span class="o">.</span><span class="n">DATE</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data_sample</span><span class="o">.</span><span class="n">WHITEFLUX</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Frequency-Domain-Filtering-Fundamentals">
<h1>Frequency Domain Filtering Fundamentals<a class="headerlink" href="#Frequency-Domain-Filtering-Fundamentals" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h2>
<p>Filtering in the frequency domain consists of modifying the Fourier transform of an signal (can be a image, a media file, a light curve…) and then taking the inverse tranform to obtained the filtered result. Thus, given a digital signal, <img class="math" src="_images/math/95aabe3d9002fe03d54b9b9d9fbfc27c0eaeb56f.png" alt="f(x)"/>, of length <img class="math" src="_images/math/4abba779877abb276b98ccb2b4ba9bf2e41947ab.png" alt="M"/>, the basic filtering equation is:</p>
<div class="math">
<p><img src="_images/math/2e2aff7d49c74481ed7122d2a3ecc60e95aabacd.png" alt="g(x) = \mathcal{F}^{-1}[H(u)F(u)] \\"/></p>
</div><p>where <img class="math" src="_images/math/5ff95e24b5c398a78a98d72248b9ebe6a7c25cb8.png" alt="\mathcal{F}^{-1}"/> is the Inverse discrete Fourier transform, <img class="math" src="_images/math/8099caf8d776fe64c3a4a905bff000d8ab13e1a3.png" alt="F(u)"/> is the Fourier transform of the given function <img class="math" src="_images/math/95aabe3d9002fe03d54b9b9d9fbfc27c0eaeb56f.png" alt="f(x)"/> (input), <img class="math" src="_images/math/5569f79c6b46681c98af28d4be4fde0f7dde31a1.png" alt="H(u)"/> is the <em>filter transfer function</em>, and <img class="math" src="_images/math/91451bcd556b3fb4efe455c92153f24ed21af9b5.png" alt="g(x)"/> is the filtered signal (output). Both <img class="math" src="_images/math/df00656702b70b4b6f7ffbf6a9aa9a334bab1914.png" alt="F"/>, <img class="math" src="_images/math/cb5de54f699cf4b3c7c1a3e87313d11d536c0d88.png" alt="H"/> and <img class="math" src="_images/math/89878909dbb648acdc4a44ded1bd982d7bddef5d.png" alt="G"/> are arrays of size <img class="math" src="_images/math/4abba779877abb276b98ccb2b4ba9bf2e41947ab.png" alt="M"/>, the same as the input signal. The product <img class="math" src="_images/math/1a80ab954839c0d2dea60c59de880cb965b12869.png" alt="H(u)F(u)"/> is formed using array multiplication; that is, <img class="math" src="_images/math/05d743635d16d89c60c328457459dca06b548f78.png" alt="G(i, k)=H(i, k)F(i, k)"/>.</p>
</div>
<div class="section" id="Expand-LightCurves-borders">
<h2>Expand LightCurves borders<a class="headerlink" href="#Expand-LightCurves-borders" title="Permalink to this headline">¶</a></h2>
<p>Para realizar a filtragem das curvas de luz nesse trabalho, utilizaremos o algoritmo da Transformada rápida de Fourier (FFT) a fim de converter o sinal em seu domínio original no domínio da frequência. A escolha do FFT é simples, o algoritmo possui complexidade de <img class="math" src="_images/math/08114d17db4208e9649bc93624edacb002ed2786.png" alt="O(N\space \log N)"/> enquanto a aplicação da definição da Transformada discreta de Fourier (DTFT) é de complexidade <img class="math" src="_images/math/40c2a7dc8dc6a308fe0705ceba2b73d876440c9c.png" alt="O(N^2)"/>, sendo <img class="math" src="_images/math/3bfb3a64189a14b2704f4610827762d5e3145114.png" alt="N"/> o tamanho dos dados, ou seja, ele é bem mais eficiente computacionalmente.</p>
<p>Porém, o FFT tem algumas particulares que podem nos gerar problemas e resultados inesperados. O algoritmo é baseado no método de dobramentos sucessivos [Gonzalez and Woods, 1992] e isso significa que ele presume que o sinal recebido seja periódico e que o número de amostras seja um número inteiro e potência de 2, mas esse último não é um requisito geral. Contudo, a primeira conjectura é bastante relavante para não termos distorção no resultado do algoritmo. Coletar <img class="math" src="_images/math/4abba779877abb276b98ccb2b4ba9bf2e41947ab.png" alt="M"/> amostras de um
sinal, o que o CoRoT fez para nós, equivale a recordar um pedaço finito do sinal real, ou seja, pegamos uma janela entre <img class="math" src="_images/math/01d790b3e1ccb4c8215afd4a382f94744bd3efd7.png" alt="T_1"/> e <img class="math" src="_images/math/0a8d6048f03583be08d939d7851b5a42974ab48c.png" alt="T-2"/> de um sinal definido de <img class="math" src="_images/math/36f4d61e084dc9046a67215fce2f40f5de46be1e.png" alt="{-\infty}"/> até <img class="math" src="_images/math/7a9bd3313f002da3071ad5a99449c05f437dea94.png" alt="{+\infty}"/>. Há a possíbilidade de que essa janela represente perfeitamente as oscilações do sinal original, em outras palavras, que ela apresente períodos completos de todas as frequências, assim teremos uma FFT sem distorções, mas é estatísticamente improvavel que isso ocorra. Nesse caso, teremos
períodos incompletos, o que irá introduzir distorções de alta frequência no sinal que, em geral, se encontrarão nas extremidades do sinal, visto que a FFT é recursiva, ou seja, o resultado do ponto <img class="math" src="_images/math/2755bb0733fef3bd4127df093f3c732d946d9823.png" alt="P+1"/> depende do resultado no ponto <img class="math" src="_images/math/c2aa3dff9bffb099e9dff196fd36aed56ec16baf.png" alt="P"/>.</p>
<p>Umas das maneiras de reduzir essas distorções é a através da escolha de diferentes janelamentos do sinal, conteudo como não queremos perder nenhum dado das curvas de luz, iremos utilizar o método de expansão das ‘bordas’ do nosso array. Dado um array <img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/> de tamanho <img class="math" src="_images/math/52ddc0cde6d632f631533173562fe3ca375b1f32.png" alt="K"/>, iremos adicionar <img class="math" src="_images/math/3bfb3a64189a14b2704f4610827762d5e3145114.png" alt="N"/> pontos antes do primeiro ponto, <img class="math" src="_images/math/c79667979ae47ce77d3b85514c4334c425057063.png" alt="A[0]"/> e <img class="math" src="_images/math/3bfb3a64189a14b2704f4610827762d5e3145114.png" alt="N"/> pontos depois do último ponto, <img class="math" src="_images/math/b4f6ef2781bc14e78f540317164705b547d045f9.png" alt="A[-1]"/>. A definição dos valores dos <img class="math" src="_images/math/3bfb3a64189a14b2704f4610827762d5e3145114.png" alt="N"/> será dada a partir do comportamento de
<img class="math" src="_images/math/1204737a5ab9868ef4fa004af3f39827daff513c.png" alt="E(i)"/>:</p>
<div class="math">
<p><img src="_images/math/f5fd02a5acdf319046c6eb414542020c7f87d5c8.png" alt="E(i) = \begin{cases}
   A[0], &amp;\text{se } i &lt; 0 \\
   A[-1], &amp;\text{se } i &gt; -1
\end{cases} \\"/></p>
</div><p>Ou seja, antes de <img class="math" src="_images/math/c79667979ae47ce77d3b85514c4334c425057063.png" alt="A[0]"/> adicionaremos <img class="math" src="_images/math/3bfb3a64189a14b2704f4610827762d5e3145114.png" alt="N"/> pontos de mesmo valor que <img class="math" src="_images/math/c79667979ae47ce77d3b85514c4334c425057063.png" alt="A[0]"/> antes do primeiro termo e depois de <img class="math" src="_images/math/b4f6ef2781bc14e78f540317164705b547d045f9.png" alt="A[-1]"/> adicionaremos <img class="math" src="_images/math/3bfb3a64189a14b2704f4610827762d5e3145114.png" alt="N"/> pontos de mesmo valor de <img class="math" src="_images/math/b4f6ef2781bc14e78f540317164705b547d045f9.png" alt="A[-1]"/> depois do último termo.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">expand_borders</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
  <span class="n">aux_pre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
  <span class="n">aux_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
  <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">aux_pre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">aux_pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">aux_pre</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">aux_pos</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">n_points_expansion</span> <span class="o">=</span> <span class="mi">70</span>

<span class="n">y_expanded</span> <span class="o">=</span> <span class="n">expand_borders</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The original length was:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;, and now we have:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_expanded</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The difference is:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_expanded</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The original length was: 23952 , and now we have: 24092
The difference is: 140
</pre></div></div>
</div>
</div>
<div class="section" id="Avoiding-wraparound-error">
<h2>Avoiding <em>wraparound</em> error<a class="headerlink" href="#Avoiding-wraparound-error" title="Permalink to this headline">¶</a></h2>
<p>O produto <img class="math" src="_images/math/3149db7e3ffdbd2df98d0cd721e1cca4b9ba08d8.png" alt="[H(u)F(u)]"/>, proveniente da equação básica da filtragem, é obtido pelo “Array product”. Considere os seguintes vetores 4x1:</p>
<div class="math">
<p><img src="_images/math/a50149db7b94cf37d300dae5a2476252d2cde058.png" alt="\begin{bmatrix}
  a_{1}\space\space a_{2}\space\space a_{3}\space\space a_{4}
\end{bmatrix} \kern1em and \kern1em
\begin{bmatrix}
  b_{1}\space\space b_{2}\space\space b_{3}\space\space b_{4}
\end{bmatrix} \\"/></p>
</div><p>O “Array product” é definido como</p>
<div class="math">
<p><img src="_images/math/1b63a816ae7d4500c9c6fd6a7a48de38106368ed.png" alt="\begin{bmatrix}
  a_{1} &amp; a_{2} &amp; a_{3} &amp; a_{4}
\end{bmatrix}
\begin{bmatrix}
  b_{1} &amp; b_{2} &amp; b_{3} &amp; b_{4}
\end{bmatrix} =
\begin{bmatrix}
  a_{1}b_{1} &amp; a_{2}b_{2} &amp; a_{3}b_{3} &amp; a_{4}b_{4}
\end{bmatrix} \\"/></p>
</div><p>O conceito de Array product nos ajuda a explicar a ocorrência do erro de <em>wraparound</em> a partir do Teorema da convolução.</p>
<p>Em matemática, convolução é um operador linear que mensura a soma do produto de duas funções dadas ao longo de uma região subentendida pela superposição das funções em função do deslocamento entre elas. Em funções discretas, é dada por:</p>
<div class="math">
<p><img src="_images/math/5a2484e0d197a5103e851ecd3de1a35583ae2d6f.png" alt="(f*g)(k) = h(k) \triangleq \sum_{j=0}^{k}f(j) \cdot g(k-j) \\"/></p>
</div><p>onde <img class="math" src="_images/math/5b7752c757e0b691a80ab8227eadb8a8389dc58a.png" alt="f"/> e <img class="math" src="_images/math/157ba5711de84b4c715a0478fd8ae440e596d96e.png" alt="g"/> são arrays de tamanho <img class="math" src="_images/math/5a939c5280da7202ca4531f175a7780ad5e1f80a.png" alt="n"/></p>
<p>O Teorema da convolução 1-D, no caso de convolução discreta, nos diz que:</p>
<div class="math">
<p><img src="_images/math/f0a84218b9a9b9fdf56ed4a8ffc2a1413d67df9a.png" alt="\mathcal{F}\{ f*g \} = k \cdot \mathcal{F}\{f\} \mathcal{F}\{g\} \\"/></p>
</div><p>Portanto, a DTF da convolução de duas funções no dominío espacial corresponde ao produto das transformadas dessas funções no domínio da frequência. Escrevendo de forma a facilitar a relação do Teorema da convolução com a equação básica da filtragem, temos:</p>
<div class="math">
<p><img src="_images/math/cddb267204b5cabb1cb5c3826936ba988efbd95d.png" alt="f(t) * h(t)  \iff F(\mu)H(\mu)"/></p>
</div><p>The double arrow means that the expression on the right side is obtained by taking the Fourier transform of the expression on the left, as well as, the expression on the left was obtained by taking the inverse Fourier transform of the expression on the right.</p>
<p>Assim, se utilizar a DTF e o Teorema da convolução para obter o mesmo resultado de filtragem, devemos tomar conta a periodicidade implícita na expressão para a DFT. Nesse caso, estaríamos aplicando a convolução à duas funções teóricamente períodicas, o que implicaria no resultado da convolução ser também periódico que, por meio de aplicações práticas nota-se ser completamente errôneo. A proximidade dos períodos de ambas funções é tamanha que eles interferem um no outro, provocando o erro de
<em>wraparound</em> (efeito de borda).</p>
<p>Já estamos minimizando esse erro realizando a expansão das extremidades do sinal, contudo essa prática pode não ser suficiente para lidar com o efeito de borda. Para tornar nosso algoritmo ainda mais robusto quanto ao erro de <em>wraparound</em> e otimizar o cálculo da FFT, aplicaremos o Zero Padding</p>
<p>Esse procedimento consiste em adicionar zeros no final do sinal do dominío espacial, antes de ser calculada sua transformada de Fourier, visando aumentar o seu tamanho. Esse procedimento é utilizado para remover a periodicidade implícita do sinal, o que acarreta em resultados inesperados no resultado da filtragem. Tal propriedade matemática está deduzida na obra Fast Fourier Transform and Its Applications by E. Brigham (1988).</p>
<p>Outra grande utilidade do Zero Padding é em otimizar o algoritmo da FFT. Como, seguindo algumas regras, podemos modificar o tamanho no nosso sinal original, é uma boa prática transformar o seu tamanho em uma potência de 2. Para prosseguirmos com esse procedimento, temos que seguir algumas regras: <a class="reference external" href="https://www.bitweenie.com/listings/fft-zero-padding/">FFT Zero Padding</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">padding</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_padded</span> <span class="o">=</span> <span class="n">padding</span><span class="p">(</span><span class="n">y_expanded</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The previous length was:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_expanded</span><span class="p">),</span> <span class="s2">&quot;, and now we have:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_padded</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The difference is:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_padded</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_expanded</span><span class="p">)</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The previous length was: 24092 , and now we have: 48184
The difference is: 24092
</pre></div></div>
</div>
</div>
<div class="section" id="Centering-the-transform">
<h2>Centering the transform<a class="headerlink" href="#Centering-the-transform" title="Permalink to this headline">¶</a></h2>
<p>Tendo aplicado o Zero Padding, o próximo passo é buscar simplificar a definição da função de transferência do filtro, <img class="math" src="_images/math/5569f79c6b46681c98af28d4be4fde0f7dde31a1.png" alt="H(u)"/>. Com base em diversas propriedades de simetria de funções, nota-se que a especificação de <img class="math" src="_images/math/5569f79c6b46681c98af28d4be4fde0f7dde31a1.png" alt="H(u)"/> é bem simplificada quando estamos trabalhando com funções simétrias ao centro, o que requer que <img class="math" src="_images/math/8099caf8d776fe64c3a4a905bff000d8ab13e1a3.png" alt="F(u)"/> também esteja centralizada.</p>
<p>A centralização das funções é demostrada pela propriedade de Translação e Rotação da transformada de Fourier:</p>
<div class="math">
<p><img src="_images/math/34705faf40b8b4fec0d71a420ab6cd2d78d707fb.png" alt="f(x) e^{j2\pi(u_0 x/M)} \iff F(u - u_0) \\"/></p>
</div><p>Isso é, multiplicar <img class="math" src="_images/math/95aabe3d9002fe03d54b9b9d9fbfc27c0eaeb56f.png" alt="f(x)"/> pelo exponencial mostrado desloca a origem da DFT para <img class="math" src="_images/math/d1a17cd80da51b6b0c6c84707c6b7ac1ebadbb5a.png" alt="u_0"/>. Tomando <img class="math" src="_images/math/f672c37c6c1e06e8274a4165769ae50d9b53b4e0.png" alt="u_0 = M/2"/>, o expoenencial passa a ser <img class="math" src="_images/math/cab46ffb2da85df2d8603f690402ba29b5da0f06.png" alt="e^{j\pi x} = (-1)^{x}"/>, estritamente pois <img class="math" src="_images/math/888f7c323ac0341871e867220ae2d76467d74d6e.png" alt="x"/> é um número inteiro. Assim,</p>
<div class="math">
<p><img src="_images/math/99ac397ea85befdf912700ec1e4c0eab52f57ab4.png" alt="f(x) (-1)^{x} \iff F(u - M/2) \\"/></p>
</div><p>Portanto, a multiplicação do sinal de input <img class="math" src="_images/math/95aabe3d9002fe03d54b9b9d9fbfc27c0eaeb56f.png" alt="f(x)"/> por <img class="math" src="_images/math/9ec9d8503ebeca93f76392ff08cd9cddb66fc223.png" alt="(-1)^{x}"/> implica no deslocamento dos dados de forma que <img class="math" src="_images/math/4bfa0adc809c863e75f6b01c9f59f6eaec49a9eb.png" alt="F(0)"/> fica no centro do intervalo <img class="math" src="_images/math/804cef0264d2464727aec7dde546912c25c6173c.png" alt="[0, M-1]"/>, como queríamos.</p>
<p>Esse procedimento deve ser feito antes de computar a transformada de Fourier da <img class="math" src="_images/math/95aabe3d9002fe03d54b9b9d9fbfc27c0eaeb56f.png" alt="f(x)"/> e ele serve para ajudar na visualização do processo de filtragem e na otimização da geração do array do fitro, portanto não é obrigatório implementa-lo.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">multiplying_by_minus_one_to_index</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
  <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">new_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)):</span>
    <span class="n">new_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">)</span>

  <span class="k">return</span> <span class="n">new_array</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_centralized</span> <span class="o">=</span> <span class="n">multiplying_by_minus_one_to_index</span><span class="p">(</span><span class="n">y_padded</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Taking-the-Fourier-transform">
<h2>Taking the Fourier transform<a class="headerlink" href="#Taking-the-Fourier-transform" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">fourier_transform</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
  <span class="n">fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">fft</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_fft</span> <span class="o">=</span> <span class="n">fourier_transform</span><span class="p">(</span><span class="n">y_centralized</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Butterworth-transfer-function">
<h2>Butterworth transfer function<a class="headerlink" href="#Butterworth-transfer-function" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">cutoff_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">order</span>       <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[98]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">butterworth_array</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
  <span class="c1"># Extrating information of the signal</span>

  <span class="n">n_time</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>                 <span class="c1">#</span>
  <span class="n">D0</span> <span class="o">=</span> <span class="n">cutoff_freq</span> <span class="o">*</span> <span class="n">n_time</span>       <span class="c1">#</span>
  <span class="n">xc</span> <span class="o">=</span> <span class="n">n_time</span>                     <span class="c1">#</span>

  <span class="c1"># Creating the filter array</span>

  <span class="n">len_filter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>         <span class="c1">#</span>
  <span class="nb">filter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">len_filter</span><span class="p">)</span>   <span class="c1">#</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_filter</span><span class="p">):</span>
    <span class="nb">filter</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="p">(</span><span class="n">xc</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span><span class="o">/</span><span class="n">D0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">order</span><span class="p">))</span>

  <span class="k">return</span> <span class="nb">filter</span>
</pre></div>
</div>
</div>
<div class="section" id="Applying-filter">
<h3>Applying filter<a class="headerlink" href="#Applying-filter" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[89]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_butter</span> <span class="o">=</span> <span class="n">butterworth_array</span><span class="p">(</span><span class="n">y_fft</span><span class="p">)</span> <span class="o">*</span> <span class="n">y_fft</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Inverse-Fourier-transform">
<h2>Inverse Fourier transform<a class="headerlink" href="#Inverse-Fourier-transform" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[90]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">inverse_fourier_transform</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
  <span class="n">ifft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">ifft</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[91]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_ifft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">inverse_fourier_transform</span><span class="p">(</span><span class="n">y_butter</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Removing-Zero-Padding">
<h2>Removing Zero-Padding<a class="headerlink" href="#Removing-Zero-Padding" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[92]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">no_padding</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">array</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[93]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_no_padding</span> <span class="o">=</span> <span class="n">no_padding</span><span class="p">(</span><span class="n">y_ifft</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Removing-borders-expanded">
<h2>Removing borders expanded<a class="headerlink" href="#Removing-borders-expanded" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[94]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">remove_expanded_borders</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
  <span class="n">aux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">s_</span><span class="p">[:</span><span class="n">param</span><span class="p">])</span>
  <span class="n">removed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">aux</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">-</span><span class="n">param</span><span class="p">:])</span>

  <span class="k">return</span> <span class="n">removed</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[95]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_no_expanded</span> <span class="o">=</span> <span class="n">remove_expanded_borders</span><span class="p">(</span><span class="n">y_no_padding</span><span class="p">,</span> <span class="n">n_points_expansion</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Re-multiplying-data-by-(-1)^{x}">
<h2>Re-multiplying data by <img class="math" src="_images/math/9ec9d8503ebeca93f76392ff08cd9cddb66fc223.png" alt="(-1)^{x}"/><a class="headerlink" href="#Re-multiplying-data-by-(-1)^{x}" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[96]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_filtered</span> <span class="o">=</span> <span class="n">multiplying_by_minus_one_to_index</span><span class="p">(</span><span class="n">y_no_expanded</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Results">
<h2>Results<a class="headerlink" href="#Results" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[97]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                           <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                           <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Original Light Curve&#39;</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_filtered</span><span class="p">,</span>
                           <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                           <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Light Curve Filtered&#39;</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Light Curve before and after the Butterworth filter&#39;</span><span class="p">,</span>
                   <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span>
                   <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Whiteflux&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Output hidden; open in https://colab.research.google.com to view.
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Generating-algorithm-…">
<h1>Generating algorithm …<a class="headerlink" href="#Generating-algorithm-…" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>Since all the Mathematical and Computacional requirements have been prosecuted, we are going to summary all this on a single algorithm.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">butterworth_filtering</span><span class="p">(</span><span class="n">original_array</span><span class="p">):</span>
  <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="01%20-%20Manipulating%20fits%20files.html" class="btn btn-neutral float-left" title="Read .fits data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Guilherme Samuel.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>